<!DOCTYPE html SYSTEM "about:legacy-compat">
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:z2="http://www.hekkelman.com/libzeep/m2" xml:lang="en" lang="en">

<head z2:replace="~{head :: head(~{::title}, ~{}, ~{::script})}">

	<title>Fishtail Plot - Phenosaurus</title>

	<script defer="defer" src="/scripts/cluster-finder.js" type="application/ecmascript" z2:src="@{/scripts/cluster-finder.js}"></script>

	<script z2:inline="javascript">
		const screenNames = /*[[${screenNames}]]*/ null;
		const screenType = /*[[${screenType}]]*/ null;
	</script>
</head>
<body>
	<nav z2:replace="menu :: menu"></nav>

	<div class="container-fluid mt-3">
		<div class="row">

			<div class="col mb-3">
				<div class="input-group input-group-sm">
					<div class="input-group-prepend">
						<label class="input-group-text" for='pv-cut-off'>p-value</label>
					</div>
					<input type="number" min="0" max="1" step="0.001" id="pv-cut-off" maxlength="8" size="5"
							placeholder="0.05"
							class="form-control" value="0.05"/>
				</div>
			</div>

			<div class="col mb-3">
				<div class="input-group input-group-sm">
						<div class="input-group-prepend">
						<label class="input-group-text" for='eps'>&#x3B5;</label>
					</div>
					<input type="number" min="0" max="1" step="0.01" id="eps" maxlength="8" size="5"
							placeholder="2"
							class="form-control" value="0.4"/>
				</div>
			</div>

			<div class="col mb-3">
				<div class="input-group input-group-sm">
					<div class="input-group-prepend">
						<label class="input-group-text" for='nns'>SNN s</label>
					</div>
					<input type="number" min="1" step="1" id="nns" maxlength="8" size="5"
							placeholder="2"
							class="form-control" value="10"/>
				</div>
			</div>

			<div class="col mb-3">
				<div class="input-group input-group-sm">
					<div class="input-group-prepend">
						<label class="input-group-text" for='minPts'>Cluster size</label>
					</div>
					<input type="number" min="2" step="1" id="minPts" maxlength="8" size="5"
							placeholder="3"
							class="form-control" value="2"/>
				</div>
			</div>
			
			<div class="col col-sm-1" z2:insert="~{gene-selection::gene-selection-dialog(screenType)}"></div>

			<div class="col col-sm-1 mb-3">
				<div class="input-group input-group-sm">
					<button class="btn btn-sm btn-primary" id="cluster-btn">Cluster</button>
				</div>
			</div>

		</div>
	</div>

	<div class="collapse container-fluid mt-4 mb-4" id="helpText">
		<div class="alert alert-info">
			<p>Clustering algorithm is DBSCAN, see <a href="https://en.wikipedia.org/wiki/DBSCAN" target="_BLANK">DBSCAN @ Wikipedia</a> for more info.</p>
			<p>Using secondary distance calculation (<a href="https://doi.org/10.1007%2F978-3-642-13818-8_34" target="_BLANK">doi: 10.1007/978-3-642-13818-8_34</a>) unless NNs is zero.</p>
		</div>
	</div>

	<div class="container-fluid mt-4 mb-4">
		<div class="plot-title">
			<span class="loading"><i class="fa fa-circle-notch fa-spin" style="font-size: 24px"></i> Searching for clusters...</span>
			<span class="loaded">Cluster results</span>
			<span class="failed">Cluster results could not be loaded.</span>
			<span class="no-hits">No clusters found</span>
		</div>
	</div>

	<div class="container-fluid">
		<table id="cluster-tabel" class="table table-hover">
			<thead>
				<tr>
					<th>nr</th>
					<th>variance</th>
					<th>cluster</th>
				</tr>
			</thead>
			<tbody>
				<tr style="display: none">
					<td></td>
					<td></td>
					<td></td>
				</tr>
			</tbody>
		</table>
	</div>

	<!-- Modal -->
	<div class="modal fade" id="displayClusterModal" tabindex="-1" role="dialog" aria-labelledby="screenModalLabel"
		aria-hidden="true">
		<div class="modal-dialog modal-dialog-scrollable modal-xl" role="document">
			<div class="modal-content">
				<div class="modal-header">
					<h5 class="modal-title" id="exampleModalLabel">Cluster</h5>
					<button type="button" class="close" data-dismiss="modal" aria-label="Close">
						<span aria-hidden="true">&#xD7;</span>
					</button>
				</div>
				<div class="modal-body">

					<div class="container-fluid mt-3">
						<div class="row">
							<div class="col-sm-1 mb-3">
								<div class="col-sm-1 mb-3">
									<div class="btn-group btn-group-sm btn-group-toggle" data-toggle="buttons" id="graphTypeBtns">
										<label class="btn btn-sm btn-secondary active"><input type="radio" name="graphType" id="heatmap" autocomplete="off" checked="checked" />Heatmap</label>
										<label class="btn btn-sm btn-secondary"><input type="radio" name="graphType" id="dotplot" autocomplete="off"/>Dotplot</label>
									</div>
								</div>
							</div>
						</div>
					</div>

					<div class="container-fluid">
						<table id="plot" cellpadding="0" cellspacing="0" class="heatmap gf-tabel no-anti table table-sm">
							<thead>
								<tr>
									<th colspan="2">Gene</th>
									<th></th>
									<th></th>
								</tr>
							</thead>
							<tbody>
								<tr style="display: none">
									<td><input type="text" readonly="readonly" class="form-control-plaintext" /></td>
									<td class="screen-status">
										<div class="swatch"></div>
									</td>
									<td class="svg-container"></td>
									<td><a href="#"> <i class="fa fa-sort-amount-up sort-screens"></i></a></td>
								</tr>
							</tbody>
							<tfoot>
								<tr>
									<td></td>
									<td class="screen-status"></td>
									<td class="label-container"></td>
									<td></td>
								</tr>
							</tfoot>
						</table>
					</div>

				</div>
				<div class="modal-footer">
					<button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
				</div>
			</div>
		</div>
	</div>

	<div class="tooltip"></div>

</body>

</html>